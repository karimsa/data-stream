"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_get=function(t,e,r){for(var n=!0;n;){var i=t,o=e,a=r;u=p=s=void 0,n=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var p=Object.getPrototypeOf(i);if(null===p)return void 0;t=p,e=o,r=a,n=!0}},Stream=require("stream"),through=require("through"),merge=require("merge-stream"),isStream=require("is-stream"),DataStream=function(t){function e(){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.readable=this.writable=!0,this._stream=through();var t=this._stream.write.bind(this._stream);this.write=function(){return t.apply(this,arguments),this},this.end=this._stream.end.bind(this._stream),this.isStream=isStream}return _inherits(e,t),_createClass(e,[{key:"clone",value:function(){var t=new e;return t._stream=this._stream,t.write=this.write,t.end=this.end,t}},{key:"pipe",value:function(t){return this._stream.pipe(t),this}},{key:"source",value:function(t){return t.pipe(this),this}},{key:"and",value:function(t){return this._stream=merge(this._stream,t),this}},{key:"append",value:function(t){return this._stream=this._stream.pipe(t),this}}]),e}(Stream),on=DataStream.prototype.on;DataStream.prototype.on=function(t,e){return"data"===t?this._stream.on("data",e):on.apply(this,arguments)},exports["default"]=function(t){return new DataStream(t)},exports.fn=DataStream.prototype,module.exports=exports["default"];var map=require("map-stream"),defer=require("promise-defer");exports.fn.filter=function(t){return this.append(map(function(e,r){var n=defer();n.promise.then(function(t){t?r(null,e):r()},r);try{var i=t.call({promise:n},e);void 0!==i&&n.resolve(i)}catch(o){n.reject(o)}}))},exports.fn.forEach=function(t){return this.map(function(e){return t(e),e})},exports.fn.join=function(t){t=t||",";var e=!0;return this.map(function(r){return e?(e=!1,r):t+r})};var map=require("map-stream"),defer=require("promise-defer");exports.fn.map=function(t){return this.append(map(function(e,r){var n=defer();n.promise.then(function(t){return r(null,t)},r);try{var i=t.call({promise:n},e);i&&n.resolve(i)}catch(o){n.reject(o)}}))};var map=require("map-stream");exports.fn.reduce=function(t,e){var r=0|e;return this.append(map(function(e,n){r=t(r,e),n(null,r)}))},exports.fn.average=function(){var t=0,e=0;return this.map(function(r){return t+=r,e+=1,t/e})},exports.fn.probability=function(){var t={},e=0,r={">":function(t,e){return t>e},"<":function(t,e){return e>t},"=":function(t,e){return t===e},">=":function(t,e){return t>=e},"<=":function(t,e){return e>=t}};return this.map(function(n){return n=String(n),t[n]||(t[n]=0),t[n]+=1,e+=1,function(n){if(r.hasOwnProperty(n[0])){var i=n[0],o=0;n=n.substr(1),"="===n[0]&&(i+="=",n=n.substr(1)),n=parseFloat(n);for(var a in t)t.hasOwnProperty(a)&&r[i](parseFloat(a),n)&&(o+=t[a]);return o/e}return t[String(n)]/e}})},exports.fn.sum=function(){return this.reduce(function(t,e){return t+parseFloat(e)},0)};var debounce=require("debounce-stream");exports.fn.debounce=function(t){return this.append(debounce(t))},exports.fn.json=function(){return this.map(function(t){return JSON.parse(t)})};var pluck=require("pluck");exports.fn.pluck=function(t){return this.map(pluck(t))},exports.fn.stdout=function(t){return this.stringify().join(t||"\n").pipe(process.stdout)},exports.fn.stringify=function(){return this.map(function(t){return"object"==typeof t?JSON.stringify(t):String(t)})};var map=require("map-stream");exports.fn.take=function(t){var e=[];return this.append(map(function(r,n){if(e.push(r),e.length===t){var i=e;e=[],n(null,i)}else n()}))};
//# sourceMappingURL=index.js.map